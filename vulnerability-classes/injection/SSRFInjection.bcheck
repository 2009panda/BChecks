metadata:
    language: v1-beta
    name: "SSRF in each insetpoint"
    description: "Inserts a injection callback into each parameter to detect SSRF"
    author: "xelkomy"

define:
    ssrfaddress="{generate_collaborator_address()}"

# we will automatically insert into nested insertion points
given insertion point then
    send payload:
        appending: {ssrfaddress}
		
	if http interactions then
        report issue:
            severity: high
            confidence: firm
            detail: "SSRF to leave autorepeater and make it with bcheck"
            remediation: "SSRF remediation"
    end if
